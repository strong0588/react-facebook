{"version":3,"sources":["../src/Profile.jsx"],"names":["Profile","Component","state","loading","handleReady","api","updateProfile","handleStatusChange","props","fields","response","getLoginStatus","status","LoginStatus","CONNECTED","setState","profile","undefined","error","getProfile","render","children","defaultProps","Fields"],"mappings":";;;;;;;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAae,MAAMA,OAAN,SAAsBC,gBAAtB,CAA8C;AAAA;AAAA;;AAAA,gDAK3DC,KAL2D,GAK5C;AACbC,eAAS;AADI,KAL4C,OAS3DC,WAT2D;AAAA,iDAS7C,WAAOC,GAAP,EAAsC;AAClD,cAAKA,GAAL,GAAWA,GAAX;;AAEA,cAAKC,aAAL;AACD,OAb0D;;AAAA;AAAA;AAAA;AAAA,eAe3DC,kBAf2D,GAetC,MAAY;AAC/B,WAAKD,aAAL;AACD,KAjB0D;AAAA;;AAmBrDA,eAAN,GAAsB;AAAA;;AAAA;AACpB,YAAM,EAAED,GAAF,EAAOG,OAAO,EAAEC,MAAF,EAAd,KAA6B,MAAnC;AACA,UAAI,CAACJ,GAAL,EAAU;AACR;AACD;;AAED,UAAI;AACF,cAAMK,WAAW,MAAML,IAAIM,cAAJ,EAAvB;AACA,YAAID,SAASE,MAAT,KAAoBC,sBAAYC,SAApC,EAA+C;AAC7C,iBAAKC,QAAL,CAAc;AACZC,qBAASC,SADG;AAEZd,qBAAS,KAFG;AAGZe,mBAAOD;AAHK,WAAd;;AAMA;AACD;;AAED,cAAMD,UAAU,MAAMX,IAAIc,UAAJ,CAAe;AACnCV;AADmC,SAAf,CAAtB;;AAIA,eAAKM,QAAL,CAAc;AACZC,iBADY;AAEZb,mBAAS,KAFG;AAGZe,iBAAOD;AAHK,SAAd;AAKD,OArBD,CAqBE,OAAOC,KAAP,EAAc;AACd,eAAKH,QAAL,CAAc;AACZC,mBAASC,SADG;AAEZd,mBAAS,KAFG;AAGZe;AAHY,SAAd;AAKD;AAjCmB;AAkCrB;;AAEDE,WAAS;AACP,UAAM,EAAEC,QAAF,KAAe,KAAKb,KAA1B;AACA,UAAM,EAAEQ,OAAF,EAAWb,OAAX,EAAoBe,KAApB,KAA8B,KAAKhB,KAAzC;;AAEA,WACE;AAAC,0BAAD;AAAA,QAAY,SAAS,KAAKE,WAA1B;AACE;AAAC,2BAAD;AAAA,UAAW,OAAM,mBAAjB,EAAqC,UAAU,KAAKG,kBAApD;AACGc,iBAAS;AACRL,iBADQ;AAERb,iBAFQ;AAGRe;AAHQ,SAAT;AADH;AADF,KADF;AAWD;AAtE0D;kBAAxClB,O;AAAAA,O,CACZsB,Y,GAAe;AACpBb,UAAQc;AADY,C","file":"Profile.js","sourcesContent":["// @flow\r\nimport React, { Component } from 'react';\r\nimport Initialize from './Initialize';\r\nimport Subscribe from './Subscribe';\r\nimport Fields from './constants/Fields';\r\nimport LoginStatus from './constants/LoginStatus';\r\n\r\ntype Props = {\r\n  children: Function,\r\n  fields?: string[],\r\n};\r\n\r\ntype State = {\r\n  loading: Boolean,\r\n  profile?: Object,\r\n  error?: Error,\r\n};\r\n\r\nexport default class Profile extends Component<Props, State> {\r\n  static defaultProps = {\r\n    fields: Fields,\r\n  };\r\n\r\n  state: State = {\r\n    loading: true,\r\n  };\r\n\r\n  handleReady = async (api: Object): Promise<void> => {\r\n    this.api = api;\r\n\r\n    this.updateProfile();\r\n  }\r\n\r\n  handleStatusChange = (): void => {\r\n    this.updateProfile();\r\n  }\r\n\r\n  async updateProfile() {\r\n    const { api, props: { fields } } = this;\r\n    if (!api) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const response = await api.getLoginStatus();\r\n      if (response.status !== LoginStatus.CONNECTED) {\r\n        this.setState({\r\n          profile: undefined,\r\n          loading: false,\r\n          error: undefined,\r\n        });\r\n\r\n        return;\r\n      }\r\n\r\n      const profile = await api.getProfile({\r\n        fields,\r\n      });\r\n\r\n      this.setState({\r\n        profile,\r\n        loading: false,\r\n        error: undefined,\r\n      });\r\n    } catch (error) {\r\n      this.setState({\r\n        profile: undefined,\r\n        loading: false,\r\n        error,\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const { children } = this.props;\r\n    const { profile, loading, error } = this.state;\r\n\r\n    return (\r\n      <Initialize onReady={this.handleReady}>\r\n        <Subscribe event=\"auth.statusChange\" onChange={this.handleStatusChange}>\r\n          {children({\r\n            profile,\r\n            loading,\r\n            error,\r\n          })}\r\n        </Subscribe>\r\n      </Initialize>\r\n    );\r\n  }\r\n}\r\n"]}