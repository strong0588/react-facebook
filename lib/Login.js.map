{"version":3,"sources":["../src/Login.jsx"],"names":["Login","handleClick","evn","preventDefault","props","handleProcess","onCompleted","onError","api","scope","fields","returnScopes","rerequest","reauthorize","eventKey","loginQpts","authType","return_scopes","push","length","auth_type","join","login","response","status","Error","getTokenDetailWithProfile","data","render","children","loading","error","Component","defaultProps","Fields","undefined","ref"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;;;;AACA;;;;AACA;;;;;;IAkBMA,K;;;;;;;;;;;;;;0JAYJC,W;0FAAc,kBAAOC,GAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AACZA,oBAAIC,cAAJ;;AADY,8BAGoC,MAAKC,KAHzC,EAGJC,aAHI,eAGJA,aAHI,EAGWC,WAHX,eAGWA,WAHX,EAGwBC,OAHxB,eAGwBA,OAHxB;AAAA;AAAA;AAAA,uBAMJF;AAAA,uGAAc,iBAAOG,GAAP;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,2CAGd,MAAKJ,KAHS,EAEhBK,KAFgB,gBAEhBA,KAFgB,EAETC,MAFS,gBAETA,MAFS,EAEDC,YAFC,gBAEDA,YAFC,EAEaC,SAFb,gBAEaA,SAFb,EAEwBC,WAFxB,gBAEwBA,WAFxB,EAEqCC,QAFrC,gBAEqCA,QAFrC;AAIZC,qCAJY,GAIA,EAAEN,YAAF,EAJA;AAKZO,oCALY,GAKD,EALC;;;AAOlB,gCAAIL,YAAJ,EAAkB;AAChBI,wCAAUE,aAAV,GAA0B,IAA1B;AACD;;AAED,gCAAIL,SAAJ,EAAe;AACbI,uCAASE,IAAT,CAAc,WAAd;AACD;;AAED,gCAAIL,WAAJ,EAAiB;AACfG,uCAASE,IAAT,CAAc,gBAAd;AACD;;AAED,gCAAIF,SAASG,MAAb,EAAqB;AACnBJ,wCAAUK,SAAV,GAAsBJ,SAASK,IAAT,CAAc,GAAd,CAAtB;AACD;;AArBiB;AAAA,mCAuBKb,IAAIc,KAAJ,CAAUP,SAAV,CAvBL;;AAAA;AAuBZQ,oCAvBY;;AAAA,kCAwBdA,SAASC,MAAT,KAAoB,WAxBN;AAAA;AAAA;AAAA;;AAAA,kCAyBV,IAAIC,KAAJ,CAAU,mBAAV,CAzBU;;AAAA;AAAA;AAAA,mCA4BCjB,IAAIkB,yBAAJ,CAA8B,EAAEhB,cAAF,EAA9B,CA5BD;;AAAA;AA4BZiB,gCA5BY;;AAAA,iCA8BdrB,WA9Bc;AAAA;AAAA;AAAA;;AAAA;AAAA,mCA+BVA,uCACDqB,IADC;AAEJb;AAFI,+BA/BU;;AAAA;AAAA,6DAqCXa,IArCW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAd;;AAAA;AAAA;AAAA;AAAA,oBANI;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AA8CV,oBAAIpB,OAAJ,EAAa;AACXA;AACD;;AAhDS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,O;;;;;;;;kBAoDdqB,M,qBAAS;AAAA,iBAGH,KAAKxB,KAHF;AAAA,QAELyB,QAFK,UAELA,QAFK;AAAA,QAEKC,OAFL,UAEKA,OAFL;AAAA,QAEcC,KAFd,UAEcA,KAFd;AAAA,QAEqBJ,IAFrB,UAEqBA,IAFrB;;;AAKP,WAAOE,SAAS;AACdC,sBADc;AAEd7B,mBAAa,KAAKA,WAFJ;AAGd8B,kBAHc;AAIdJ;AAJc,KAAT,CAAP;AAMD,G;;;EA3EiBK,gB,UACXC,Y,GAAe;AACpBxB,SAAO,EADa;AAEpBC,UAAQwB,gBAFY;AAGpBvB,gBAAc,KAHM;AAIpBC,aAAW,KAJS;AAKpBC,eAAa,KALO;AAMpBP,eAAa6B,SANO;AAOpB5B,WAAS4B,SAPW;AAQpBrB,YAAUqB;AARU,C;kBA6ET,uBAAW,UAAC/B,KAAD,EAAQgC,GAAR;AAAA,SACxB;AAAC,qBAAD;AAAA;AACG;AAAA,UACCN,OADD,SACCA,OADD;AAAA,UACUzB,aADV,SACUA,aADV;AAAA,UACyBsB,IADzB,SACyBA,IADzB;AAAA,UAC+BI,KAD/B,SAC+BA,KAD/B;AAAA,aAGC,8BAAC,KAAD,6BACM3B,KADN;AAEE,iBAAS0B,OAFX;AAGE,uBAAezB,aAHjB;AAIE,cAAMsB,IAJR;AAKE,eAAOI,KALT;AAME,aAAKK;AANP,SAHD;AAAA;AADH,GADwB;AAAA,CAAX,C","file":"Login.js","sourcesContent":["// @flow\r\nimport React, { Component, forwardRef } from 'react';\r\nimport Process from './Process';\r\nimport Fields from './constants/Fields';\r\n\r\ntype Props = {\r\n  children: Function,\r\n  handleProcess: Function,\r\n  loading: boolean,\r\n  data: any,\r\n  error: Error,\r\n  scope?: string,\r\n  fields?: string[],\r\n  returnScopes?: boolean,\r\n  rerequest?: boolean,\r\n  reauthorize?: boolean,\r\n  onCompleted?: Function,\r\n  onError?: Function,\r\n  eventKey?: any,\r\n};\r\n\r\nclass Login extends Component<Props> {\r\n  static defaultProps = {\r\n    scope: '',\r\n    fields: Fields,\r\n    returnScopes: false,\r\n    rerequest: false,\r\n    reauthorize: false,\r\n    onCompleted: undefined,\r\n    onError: undefined,\r\n    eventKey: undefined,\r\n  };\r\n\r\n  handleClick = async (evn) => {\r\n    evn.preventDefault();\r\n\r\n    const { handleProcess, onCompleted, onError } = this.props;\r\n\r\n    try {\r\n      await handleProcess(async (api) => {\r\n        const {\r\n          scope, fields, returnScopes, rerequest, reauthorize, eventKey,\r\n        } = this.props;\r\n        const loginQpts = { scope };\r\n        const authType = [];\r\n\r\n        if (returnScopes) {\r\n          loginQpts.return_scopes = true;\r\n        }\r\n\r\n        if (rerequest) {\r\n          authType.push('rerequest');\r\n        }\r\n\r\n        if (reauthorize) {\r\n          authType.push('reauthenticate');\r\n        }\r\n\r\n        if (authType.length) {\r\n          loginQpts.auth_type = authType.join(',');\r\n        }\r\n\r\n        const response = await api.login(loginQpts);\r\n        if (response.status !== 'connected') {\r\n          throw new Error('Unauthorized user');\r\n        }\r\n\r\n        const data = await api.getTokenDetailWithProfile({ fields });\r\n\r\n        if (onCompleted) {\r\n          await onCompleted({\r\n            ...data,\r\n            eventKey,\r\n          });\r\n        }\r\n\r\n        return data;\r\n      });\r\n    } catch (error) {\r\n      if (onError) {\r\n        onError(error);\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      children, loading, error, data,\r\n    } = this.props;\r\n\r\n    return children({\r\n      loading,\r\n      handleClick: this.handleClick,\r\n      error,\r\n      data,\r\n    });\r\n  }\r\n}\r\n\r\nexport default forwardRef((props, ref) => (\r\n  <Process>\r\n    {({\r\n      loading, handleProcess, data, error,\r\n    }) => (\r\n      <Login\r\n        {...props}\r\n        loading={loading}\r\n        handleProcess={handleProcess}\r\n        data={data}\r\n        error={error}\r\n        ref={ref}\r\n      />\r\n    )}\r\n  </Process>\r\n));\r\n"]}